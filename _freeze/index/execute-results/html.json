{
  "hash": "0c8833232c7b9d3d3e5070d67c9c46c4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ESS 330 Final Project: Emissions in the Top CO₂ Polluting Countries Before and After COVID-19\"\nauthor:\n  - name: \"Yazeed Aljohani\"\n    affiliation: \"Colorado State University\"\n  - name: \"Josh Puyear\"\n    affiliation: \"Colorado State University\"\n  - name: \"Cade Vanek\"\n    affiliation: \"Colorado State University\"\ndate: 2025-04-24\"\nbibliography: references.bib\nkeywords: [CO2 emissions, COVID-19, GHG, workflow, ANOVA, sustainability]\nabstract: |\n  This project investigates trends in per capita greenhouse gas (GHG) emissions from the five largest CO2-polluting countries before, during, and after the COVID-19 pandemic. Using `ghg_excluding_lucf_per_capita` as the main variable, we analyze patterns in emissions and identify key predictors across sectors (e.g., manufacturing, transport). The study applies workflow modeling and ANOVA to examine emission changes and variation across countries. Results will inform strategies to reduce emissions and guide sustainable policy efforts.\n---\n\n\n\n\n\n# Introduction, Background, and Motivation\n\nClimate change remains one of the most urgent global challenges, driven in large part by human greenhouse gas emissions. Among these, carbon dioxide is the most significant. Carbon dioxide is released through many activities such as burning fossil fuels, industrial production, and land-use practices. Even though international efforts like the Paris Agreement have pushed countries to reduce emissions, many continue to show increasing trends. A small group of countries contributes the most emissions globally, both in total and per person. These major contributors include countries like China, the United States, and India [@friedlingstein2019global].\n\nThis project focuses on the five largest carbon dioxide polluting countries: China, the United States, India, Russia, and Japan. These countries are responsible for a significant share of global emissions and reflect a range of economic systems, energy sources, and industrial structures. To allow meaningful comparisons, we center our analysis on greenhouse gas emissions per person, using the variable ghg_excluding_lucf_per_capita. This variable removes land-use change from the emissions total, isolating emissions from industrial activity and fossil fuel use. By using this approach, we can better understand how much pollution is tied to each person’s activity and consumption within each country.\n\nThe COVID-19 pandemic created a global disruption that affected travel, trade, and production. Lockdowns and other restrictions slowed down factories, reduced transportation, and caused shifts in energy use. As a result, global carbon dioxide emissions in 2020 dropped by approximately 5.4 percent, marking the largest single-year decrease in history [@forster2020current]. This sudden drop was mostly due to temporary changes. As countries began reopening in 2021 and 2022, emissions started climbing again.\n\nOur goal is to analyze how emissions changed in these five countries before, during, and after the pandemic. We look at three main periods: before COVID from 2015 to 2019, the year COVID began in 2020, and the early recovery years from 2021 to 2022. By studying per person emissions during these periods, we can see whether there were real shifts in emissions behavior and whether those shifts continued into recovery. We also want to understand what kinds of emissions changed the most. For example, did transportation-related emissions drop more than industrial ones? Did countries with manufacturing-based economies recover differently than those with service-based ones?\n\nTo explore these questions, we use two main methods. First, we build a workflow model using the tidymodels package in R. This lets us see which emission sources are the strongest predictors of overall greenhouse gas output per person. For example, we compare emissions from coal, oil, gas, cement, and other industry sectors. We also include factors like population and economic output. By analyzing these predictors, we can understand which sources matter most in each country and how they are connected to changes over time. Second, we use ANOVA to test whether the changes in emissions across the three time periods are statistically meaningful. We run this analysis for each country and compare their patterns.\n\nThe reason for focusing on per person emissions is that total emissions alone do not tell the full story. Countries with large populations may seem like major polluters in total, but their emissions per person might be lower than smaller, high-emitting countries. A per person view also reflects differences in daily life, energy use, and infrastructure. This is important for climate policy, because it shows whether emissions are driven by large populations, high-intensity consumption, or both.\n\nOur analysis helps link data analysis to climate solutions. By identifying what types of emissions dropped the most during the pandemic and which ones came back quickly, we can suggest where to focus efforts. If, for instance, oil-related emissions dropped during lockdowns but then returned quickly, that might show a need for deeper investment in alternative transportation options. If manufacturing emissions remained stable, that could show how industrial processes are harder to change without long-term plans and policies.\n\nThis project is also a chance to make emissions data more relatable. People often hear that emissions went down during the pandemic, but they may not know what caused the change or how long it lasted. By using clear visuals and country comparisons, we can help explain these trends to wider audiences. This is especially important as the world faces increasing climate-related disasters. Understanding emission trends can support smarter planning and better communication around sustainable transitions.\n\nLastly, we are motivated by a bigger question: what can we learn from this accidental global experiment? The pandemic gave the world a chance to see what happens when daily life suddenly changes. Some of those changes, like working from home or using less transportation, might become long-term habits. Others may disappear as economies reopen. By analyzing which emission reductions lasted and which faded, we can start to imagine more realistic and effective ways to slow down climate change.\n\n#### Research Question\n\nHow did per capita greenhouse gas emissions change before, during, and after COVID-19 in the five largest CO₂-polluting countries, and which sector-specific emissions are the strongest predictors of these changes?\n\n# \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(tidyr)\n\ndata <- read_csv(\"data/owid-co2-data (1).csv\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 50191 Columns: 79\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): country, iso_code\ndbl (77): year, population, gdp, cement_co2, cement_co2_per_capita, co2, co2...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n\n\n# Data Exploration & Methods:\n\n### Data Source\n\n-   We used greenhouse gas emissions data from Our World in Data [@owid-scaling-up-ai], which compiles information from the Global Carbon Project and other sources.\n\n-   Focused years: 2015–2022.\n\n-   Countries: China, United States, India, Russia, and Japan (top 5 emitters).\n\n### Data Cleaning\n\nFiltered for years 2015–2022.\n\nSelected countries with valid ISO codes and the top 5 CO₂-polluting countries.\n\nSelected key variables: ghg_excluding_lucf_per_capita, coal_co2, oil_co2, gas_co2, cement_co2, and other_industry_co2.\n\nCreated a new variable period to group years into pre-COVID (2015–2019), during COVID (2020), and post-COVID (2021–2022).\n\n### Data Exploration\n\n-   Plotted per capita GHG emissions over time for each country.\n\n-   Plotted sector-specific CO₂ emissions by country and year.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndata_filtered <- data |>\n  filter(year >= 2015, year <= 2022) |>\n  filter(!is.na(iso_code) & nchar(iso_code) == 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Getting top 5 CO2 emitting countries by total GHG (excluding land use)\ntop_emitters <- data_filtered |>\n  group_by(country) |>\n  summarise(total_ghg = sum(total_ghg_excluding_lucf, na.rm = TRUE)) |>\n  arrange(desc(total_ghg)) |>\n  slice_head(n = 5) |>\n  pull(country)\n\n# Filtering data to include only those countries and select relevant variables\ndf <- data_filtered |>\n  filter(country %in% top_emitters) |>\n  select(country, year, ghg_excluding_lucf_per_capita,\n         coal_co2, gas_co2, oil_co2, cement_co2, other_industry_co2)\ndf <- df |> drop_na(ghg_excluding_lucf_per_capita)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Adding period category (pre, during, post COVID)\ndf <- df |>\n  mutate(period = case_when(\n    year <= 2019 ~ \"pre_covid\",\n    year == 2020 ~ \"during_covid\",\n    year >= 2021 ~ \"post_covid\"\n  )) |>\n  mutate(period = factor(period, levels = c(\"pre_covid\", \"during_covid\", \"post_covid\")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot(df, aes(x = factor(year), y = ghg_excluding_lucf_per_capita, color = country, group = country)) +\n  geom_line() +\n  geom_point() +\n  labs(\n    title = \"Per Capita GHG Emissions (Excl. Land Use) by Country (2015–2022)\",\n    x = \"Year\", y = \"GHG per Capita (tCO₂e)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\nThise graph shows how greenhouse gas emissions per person changed in China, the United States, India, Russia, and Japan from 2015 to 2022. You can see a drop around 2020 during COVID, especially in the United States and Russia. Some countries' emissions started going back up after 2020.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Pivot longer and remove missing emissions\ndf_long <- df |> \n  pivot_longer(cols = c(coal_co2, gas_co2, oil_co2, cement_co2, other_industry_co2),\n               names_to = \"sector\", values_to = \"emissions\") |> \n  drop_na(emissions)\n\n# Plot\nggplot(df_long, aes(x = year, y = emissions, color = sector, group = interaction(sector, country))) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(~ country, scales = \"free_y\", ncol = 2) +  # Make panels wider\n  scale_x_continuous(breaks = 2015:2022) +              # Show all years\n  labs(title = \"Sector-specific CO₂ Emissions (2015–2022)\", \n       x = \"Year\", \n       y = \"Emissions (MtCO₂)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate year labels\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\nThis graph shows where each country's emissions came from — like coal, oil, gas, cement, or other industries. For example, China has a lot of coal emissions, and the United States has more oil emissions. You can also see how emissions from some sectors dropped in 2020 and then changed again after COVID.\n\n### Statistical Analyses\n\n-   ANOVA: Tested whether there were significant differences in per capita GHG emissions across the three periods (pre-, during-, post-COVID) for each country.\n\n-   Linear Regression: Modeled per capita GHG emissions (ghg_excluding_lucf_per_capita) as a function of sector-specific CO₂ emissions (coal_co2, oil_co2, gas_co2, cement_co2, other_industry_co2).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Running ANOVA on each country if they have more than one period\nfor (c in unique(df$country)) {\n  df_country <- df |> filter(country == c)\n  if (n_distinct(df_country$period) > 1) {\n    cat(\"\\n--- ANOVA for\", c, \"---\\n\")\n    model <- aov(ghg_excluding_lucf_per_capita ~ period, data = df_country)\n    print(summary(model))\n  } else {\n    cat(\"\\n--- Skipped ANOVA for\", c, \": not enough periods ---\\n\")\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n--- ANOVA for China ---\n            Df Sum Sq Mean Sq F value Pr(>F)  \nperiod       2 1.2803  0.6402   13.06 0.0103 *\nResiduals    5 0.2451  0.0490                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n--- ANOVA for India ---\n            Df  Sum Sq  Mean Sq F value Pr(>F)\nperiod       2 0.04456 0.022280   2.956  0.142\nResiduals    5 0.03769 0.007537               \n\n--- ANOVA for Japan ---\n            Df Sum Sq Mean Sq F value Pr(>F)  \nperiod       2 1.6155  0.8077   7.299 0.0329 *\nResiduals    5 0.5533  0.1107                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n--- ANOVA for Russia ---\n            Df Sum Sq Mean Sq F value Pr(>F)  \nperiod       2 1.3923  0.6961   4.433 0.0781 .\nResiduals    5 0.7852  0.1570                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n--- ANOVA for United States ---\n            Df Sum Sq Mean Sq F value  Pr(>F)   \nperiod       2  4.906  2.4529   21.37 0.00355 **\nResiduals    5  0.574  0.1148                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n| Country       | p-value | Interpretation                    |\n|:--------------|:--------|:----------------------------------|\n| China         | 0.0103  | Significant change (p \\< 0.05)    |\n| India         | 0.142   | No significant change (p \\> 0.05) |\n| Japan         | 0.0329  | Significant change (p \\< 0.05)    |\n| Russia        | 0.0781  | Not quite significant (p \\> 0.05) |\n| United States | 0.00355 | Significant change (p \\< 0.01)    |\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlm_model <- lm(ghg_excluding_lucf_per_capita ~ coal_co2 + oil_co2 + gas_co2 + cement_co2 + other_industry_co2, data = df)\nsummary(lm_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = ghg_excluding_lucf_per_capita ~ coal_co2 + oil_co2 + \n    gas_co2 + cement_co2 + other_industry_co2, data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.2833 -0.3541  0.1507  0.4693  1.4989 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         8.2798981  0.3661956  22.611  < 2e-16 ***\ncoal_co2            0.0003590  0.0008477   0.424 0.675372    \noil_co2            -0.0021149  0.0005530  -3.825 0.000737 ***\ngas_co2             0.0074705  0.0008038   9.293 9.53e-10 ***\ncement_co2         -0.0237091  0.0076398  -3.103 0.004572 ** \nother_industry_co2  0.0864354  0.0379252   2.279 0.031111 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9042 on 26 degrees of freedom\n  (8 observations deleted due to missingness)\nMultiple R-squared:  0.9521,\tAdjusted R-squared:  0.9429 \nF-statistic: 103.3 on 5 and 26 DF,  p-value: 2.663e-16\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Model Validation\n\n-   Plotted actual vs. predicted emissions to assess model fit.\n\n-   Visualized regression coefficients with confidence intervals to interpret the influence of each emission sector.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# After selecting the variables, clean properly:\ndf <- df |> drop_na(ghg_excluding_lucf_per_capita, coal_co2, oil_co2, gas_co2, cement_co2, other_industry_co2)\n\n# Now build the model\nlm_model <- lm(ghg_excluding_lucf_per_capita ~ coal_co2 + oil_co2 + gas_co2 + cement_co2 + other_industry_co2, data = df)\n\n# Now add predictions\ndf$predicted <- predict(lm_model)\n\n# Now plot Actual vs Predicted\nggplot(df, aes(x = ghg_excluding_lucf_per_capita, y = predicted, color = country)) +\n  geom_point(size = 2) +\n  geom_abline(slope = 1, intercept = 0, linetype = \"dashed\") +\n  labs(title = \"Actual vs Predicted GHG per Capita\",\n       x = \"Actual GHG per Capita\",\n       y = \"Predicted GHG per Capita\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n\nThis graph compares the real emissions to the ones predicted by our model. If the points are close to the dashed line, it means the model did a good job. Most of the points are pretty close to the line, so the model worked well.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(broom)\n\ntidy_lm <- broom::tidy(lm_model)\n\nggplot(tidy_lm[-1, ], aes(x = estimate, y = reorder(term, estimate))) + \n  geom_point(size = 3) +\n  geom_errorbarh(aes(xmin = estimate - std.error, xmax = estimate + std.error), height = 0.2) +\n  labs(title = \"Regression Coefficients for Sector CO₂ Emissions\",\n       x = \"Coefficient Estimate\",\n       y = \"Predictor\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n\nThis figure showes regression coefficients showing the relationship between sector-specific CO₂ emissions and per capita GHG emissions. Gas emissions were the strongest positive predictor, while oil and cement emissions were negatively associated with per capita emissions. Error bars represent standard errors.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}